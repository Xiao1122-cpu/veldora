<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thanh to√°n VNPay Demo</title>
</head>
<body>
  <h2>Thanh to√°n VNPay tr·ª±c ti·∫øp (demo h·ªçc t·∫≠p)</h2>
  <input type="number" id="amount" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VND)" />
  <button id="payBtn">Thanh to√°n VNPay</button>

  <script>
    // üîí Th√¥ng tin sandbox (thay YOUR_TMNCODE b·∫±ng m√£ th·∫≠t t·ª´ VNPay)
    const vnp_TmnCode = "YOUR_TMNCODE"; // v√≠ d·ª•: "2QXUI4J4"
    const vnp_Url = "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html";
    const vnp_ReturnUrl = "http://localhost:5500/vnpay_return.html";

    document.getElementById("payBtn").addEventListener("click", () => {
      const amount = document.getElementById("amount").value || 100000;
      const date = new Date();

      // Format yyyyMMddHHmmss
      const formatDate = `${date.getFullYear()}${String(date.getMonth() + 1).padStart(2, "0")}${String(date.getDate()).padStart(2, "0")}${String(date.getHours()).padStart(2, "0")}${String(date.getMinutes()).padStart(2, "0")}${String(date.getSeconds()).padStart(2, "0")}`;

      const orderId = formatDate; // m√£ ƒë∆°n h√†ng
      const params = {
        vnp_Version: "2.1.0",
        vnp_Command: "pay",
        vnp_TmnCode: vnp_TmnCode,
        vnp_Amount: amount * 100, // ph·∫£i nh√¢n 100
        vnp_CurrCode: "VND",
        vnp_TxnRef: orderId,
        vnp_OrderInfo: encodeURIComponent("Thanh toan don hang " + orderId),
        vnp_OrderType: "other",
        vnp_Locale: "vn",
        vnp_ReturnUrl: vnp_ReturnUrl,
        vnp_IpAddr: "127.0.0.1",
        vnp_CreateDate: formatDate,
      };

      // üß© T·∫°o URL
      const query = Object.entries(params)
        .map(([key, value]) => `${key}=${value}`)
        .join("&");

      const paymentUrl = `${vnp_Url}?${query}`;
      console.log(paymentUrl);

      window.location.href = paymentUrl;
    });
  </script>
</body>
</html>
